<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surgical Pathways Sankey Diagram</title>
    <link rel="stylesheet" href="style.css">
    <script type="module" src="global.js"></script>
    <script type="module" src="question.js"></script>
    <script type="module" src="departments.js"></script>
</head>
<body>
    <div class="header-container">
        <h1>How long will a patient stay in the hospital to recover from surgery?</h1>
        <div class="description">
            <p>Have you ever thought about what happens when you undergo surgery? You likely have questions going through your mind, such as:</p>
                <p class="highlight">"Will I survive?"</p>
                <p class="highlight">"How long do I need to recover?"</p>
            <p>To help alleviate these concerns, we investigated data from patients undergoing surgery at the Seoul National University Hospital, Republic of Korea.</p>
        </div>
    </div>

    <!-- Flex container for the two sections -->
    <div class="content-container">
        <!-- Container for the questionnaire section -->
        <div class="questionnaire-section">
            <div id="questionnaire-container"></div>
        </div>
    </div>

    
    <!-- The interactive barchart will be created by departments.js -->
    <div class="container" id="departments_vis">
        <button id="backButton" style="display: none;">Back to Main Visualization</button>
        <div id="barchart"></div>
        <div id="legend"></div>
        <div id="tooltip"></div>
    </div>

    <div class="container">
        <div class="step-indicator">
            <button class="step sankey-step">1<div class="step-line"></div></button>
            <button class="step sankey-step">2<div class="step-line"></div></button>
            <button class="step sankey-step">3</button>
        </div>
        
        <div class="controls">
            <button id="resetBtn">Reset View</button>
            <button id="animateBtn">Animate Diagram</button>
            <button id="prevBtn" disabled>Previous Step</button>
            <button id="nextBtn">Next Step</button>
        </div>
        
        <div id="chart"></div>
        
        <div class="flex-container">
            <div class="info-box">
                <strong>How to interact:</strong>
                <ul>
                    <li>Hover over connections to see the patient flow</li>
                    <li>Click on a node to filter the diagram and focus on that pathway</li>
                    <li>Use the animation controls to see the diagram build step by step</li>
                    <li>Use the Reset button to clear any filters and return to the full view</li>
                </ul>
            </div>
            <div class="legend-container"></div>
        </div>
    </div>

    <!-- External scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-sankey/0.12.3/d3-sankey.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</body>
</html>